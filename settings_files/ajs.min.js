void function(){"use strict";function u(Z){var a=null,f,c,h=Z.length,d,g=[];for(f=0;f<h;++f)if((d=Z[f])&&d.ajs&&d instanceof s)for(a=0,c=d.length;a<c;++a)g.push(d[a]);else"string"===typeof d&&(d=b.createTextNode(d)),d.nodeType&&g.push(d);if(1===(h=g.length))a=g[0];else for(a=b.createDocumentFragment(),f=0;f<h;++f)a.appendChild(g[f]);return a}function n(a,b,f,c,h){if((h=String(h||""))&&a.test(h))for(a=7;a--;)~h.indexOf(this[a+b])&&(h=h.replace(this[a+f],this[a+c]));return h}function p(a,b){var f=0,h="length"in
this&&!("nodeType"in this)&&this.length||0,c=h&&this[0]||this,d,g,k;b=b.replace(x," ").split(z);k=L&&(2===L||1===b.length?2:1);do c&&(m(c)&&k&&"string"==typeof a?(c=c.classList,2===k?c[a].apply(c,b):Array.forEach(b,c[a].bind(c))):"string"===typeof(d=c[t])&&((g=d.length)?(d=(" "+d+" ").replace(x),g=d.length,d=Array.reduce(b,a,d)+""):d=b.join(" "),g!==d.length&&(c[t]=d.trim()))),c=f++<h?this[f]:null;while(c);return this}function A(a,b){return m(b)&&Array.every(a,L?b.classList.contains.bind(b.classList):
ga.bind(null,(" "+b[t]+" ").replace(x," ")))}function m(a){return a&&1===a.nodeType}function e(){this.cancelBubble=!0}function r(){this.returnValue=!1}function E(a,D){a.__fixed||(a.target||(a.target=a.srcElement||b),3===a.target.nodeType&&(a.target=a.target.parentNode),a.currentTarget||(a.currentTarget=D),!a.relatedTarget&&a.fromElement&&(a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement),a.stopPropagation||(a.stopPropagation=e),a.preventDefault||(a.preventDefault=r),!a.which&&"button"in
a&&(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0),a.__fixed=!0);return a}function q(a){var D=this.ct,f,c=v[this.k],h,d=0,k=c&&c.length;!0===D?D=g:!1===D?D=b:"string"===typeof D&&(D=b.all[D]);if(k)for(a=E.call(null,a||g.event,D);d<k;d++)if(h=c[d])"object"===typeof h&&(f=h,h=s.__processHandler(h)),!1===h.call(f||D,a)&&(a.returnValue=!1);return a.returnValue}function c(a,D,f,c){f=f.split(z);var h=0,d,k="length"in a&&!("nodeType"in a)&&a.length||0,l=k&&a[0]||a,C=f.length,x,t,e,y,B=c;if(l){do{if(Object.isObject(l)&&
l[$])for(d=0;d<C;d++){x=f[d];if(!P)if(c=B,c[G]||(c[G]="_"+s.gid++),x="on"+x,t=l!==g&&l!==b&&"uniqueID"in l?l.uniqueID:l[G]||(l[G]="_"+s.gid++),t=t+"_"+x,y=v[t],D)e="uniqueID"in l&&l!==b?l.uniqueID:l===g?!0:l===b?!1:l,e={ct:e,k:t},y?(void 0===y[c[G]]&&(y[c[G]]=null,y.push(c)),c=null):(y=v[t]=[c],y[c[G]]=null,c=v[t+"_"]=q.bind(e));else if(y){for(e=y.length;0<=--e&&y[e]!==c;);-1!==e&&y.splice(e,1);(e=c[G])&&delete y[e];y.length?c=null:(c=v[t+"_"],delete v[t+"_"],delete v[t])}if(c)l[D?$:w](x,c,!1)}l=
h++<k?a[h]:null}while(l)}return a}function l(a,b){if(void 0!==b){var f={};f[a]=b;return f}return a}function y(a,D){for(var f,c=[],d=0,g=a.length,l=D.indexOf(" "),C=(~l?D.substr(0,l):D).replace(z),t,x;d<g;d++)f=a[d],~l&&aa?f=f.querySelectorAll(D):(x=C.substr(1),t=C.charAt(0),"#"===t?f=(f=b[ha](x))?[f]:[]:"."===t?f=ia(x.replace(h," "),f):(t=C.split("."),f=f[B](t[0]),f=I(C,".")?k(f,null,t.slice(1)):Array.from(f))),f.length&&(~l&&!aa&&(f=y(f,D.substr(l+1))),c=c.concat(F.call(f,0)));return c}function k(a,
b,f){var c=[],d=0,g=a.length,k;b&&(b=b.toUpperCase());for(f&&"string"==typeof f&&(f=f.replace(h," ").split(z));d<g;d++)k=a[d],!m(k)||(b&&b!=k.tagName.toUpperCase()||f&&!A(f,k))||c.push(k);return c}var g=this,d={},a;a="0.13.4";parseFloat(a)||(a="0.13.0");d.version=a;g["ajs"+d.version]=d;g.ajs||(g.ajs=d);Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if(1<arguments.length){var f=F.call(arguments,1);return function(){return b.apply(a,f.concat(F.call(arguments,0)))}}return function(){return b.apply(a,
arguments)}});var b=g.document,f="attachEvent"in b&&"all"in b&&"uniqueID"in b.documentElement&&+((/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0)||null,h=/\./g,C=/^\d+/,z=/\s+/,x=/[\r\n\t]/g,t="className",ha="getElementById",B="getElementsByTagName",P="addEventListener"in b,v=!P&&{},$=P?"addEventListener":"attachEvent",w=P?"removeEventListener":"detachEvent",aa=!!b.querySelectorAll,ja={fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},F=(a=Array.prototype).slice,
M=a.forEach,J=a.filter,N=a.reduce,U=a.every,ba=a.some,ka=/^\s+/,la=/\s/,ma="a"!=Object("a")[0]||!(0 in Object("a")),Q=function(a,b){if(null==a&&!b)throw new TypeError;return ma&&"string"==typeof a&&a?String.prototype.split.call(a,""):Object(a)},na=String.prototype.trim||function(){for(var a=this.replace(ka,""),b=a.length;la.test(a.charAt(--b)););return a.slice(0,b+1)},I;a="\t\n\x0B\f\r \u00a0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff";
var ca,da,oa=Function.prototype.apply,V=Function.prototype.call,W=function(a,b,f){return oa.call(a,b,F.call(arguments,2))},K=V.bind(Object.prototype.hasOwnProperty),L="classList"in b.documentElement&&function(a){a.classList.add(1,2);return a.classList.contains(2)?2:1}(b.createElement("b")),ea,fa,R=("_"+Math.random()).substr(3,6),G="uuid"+R,O=Object.prototype.toString,H,X;String.prototype.contains||(String.prototype.contains=function(a,b){return!!~String(this).indexOf(a,b|0)});I=V.bind(String.prototype.contains);
String.prototype.startsWith||(String.prototype.startsWith=function(a,b){a=String(a);if(!a.length)return!0;b|=0;0>b&&(b=0);return this.charCodeAt(b)===a.charCodeAt(0)&&this.indexOf(a,b)===b});String.prototype.endsWith||(String.prototype.endsWith=function(a,b){a=String(a);var f=a.length|0;if(!f)return!0;var c=this.length;b=void 0===b?c:b|0;if(1>b)return!1;c=(c<b?c:b)-f;return(0<=c||f===-c)&&(0===b||this.charCodeAt(c)===a.charCodeAt(0))&&this.indexOf(a,c)===c});Object.create||(Object.create=function(a){var b;
null===a?b={__proto__:null}:(b=function(){},b.prototype=a,b=new b,b.__proto__=a);return b});Object.keys||(Object.keys=function(a){var b,f,c=!{toString:null}.propertyIsEnumerable("toString"),h,d;c&&(b="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),f=b.length);for(a in arguments){a=!1;break}!1!==a&&(a=!0,"[object Arguments]"!==(d=O.call(arguments))&&(d=!1,h="caller"in arguments));return function(g){if("object"!==typeof g&&"function"!==typeof g||
null===g)throw new TypeError("Object.keys called on a non-object");var k=[],l;for(l in g)K(g,l)&&k.push(l);if(c)for(l=0;l<f;l++)K(g,b[l])&&k.push(b[l]);var C;if(a&&(d?O.call(g)===d:"object"===typeof g&&"callee"in g&&(!h||"caller"in g)&&"number"===typeof(C=g.length)))for(l=0;l<C;l++)K(g,l)&&k.push(l);return k}}(null));Object.isObject=function(a){var b;return!!a&&("object"===(b=typeof a)||"function"===b)};Object.isPlainObject=function(a){return!!a&&"[object Object]"===O.call(a)&&("function"===typeof a.constructor&&
"[object Function]"===O.call(a.constructor)||null===a.__proto__)&&!K(a,"callee")};Object.forEach||(Object.forEach=function(a,b,f){if("function"!==typeof b)throw new TypeError(b+" is not a function");var c;if(a)for(c in a)if(K(a,c)&&!1===b.call(f,a[c],c,a))break});if(!String.prototype.trim||a.trim())a="["+a+"]",ca=RegExp("^"+a+a+"*"),da=RegExp(a+a+"*$"),String.prototype.trim=function(){return String(this).replace(ca,"").replace(da,"")};Function.prototype.throttle||(Function.prototype.throttle=function(a,
b){var f=this,c,h;return function(){var d;h=arguments;c||(d=function(){c=null;h&&(f.apply(this,h),h=null,c=setTimeout(d,a))}.bind(b||this),d())}});Function.prototype.debounce||(Function.prototype.debounce=function(a,b){var f=this,c;return function(){clearTimeout(c);c=setTimeout(function(a){f.apply(this,a)}.bind(b||this,arguments),a)}});Number.isNumber||(Number.isNumber=function(a){return!g.isNaN(g.parseFloat(a))&&g.isFinite(a)});Number.isNumeric=function(a){return!g.isNaN(g.parseFloat(a))&&g.isFinite(a)};
Number.isFinite||(Number.isFinite=function(a){return"number"===typeof a&&g.isFinite(a)});Number.isInteger||(Number.isInteger=function(a){return Number.isFinite(a)&&-9007199254740992<=a&&9007199254740992>=a&&Math.floor(a)===a});var s=function(a,f){if(!(this instanceof s))return new s(a,f);if(a&&a.ajs===R&&a instanceof s)return a;this.length=0;this.selector="string"==typeof a?a:"";if(a)if("body"===a)this[0]=b.body,this.length=1;else if(a===g)this[0]=g,this.length=1;else if("string"===typeof a)if(this.context=
f=f||b,"<"==a.charAt(0)){var c=b.createElement("div");c.innerHTML=a;this.push(c.childNodes)}else this.push(y(s(f),a));else a&&(1==a.nodeType||9==a.nodeType?(this[0]=a,this.length=1):this.push(a));return this};Array.forEach||(Array.forEach=M?function(a,b,f){return M.apply(a,F.call(arguments,1))}:function(a,b,f){for(var c=Q(a),h=c.length>>>0,d=-1;++d<h;)d in c&&W(b,f,c[d],d,a)});Array.filter||(Array.filter=J?function(a,b,f){return J.apply(a,F.call(arguments,1))}:function(a,b,f){a=Q(a);for(var c=a.length>>>
0,h=[],d,g=0;g<c;g++)g in a&&(d=a[g],W(b,f,d,g,a)&&h.push(d));return h});Array.reduce||(Array.reduce=N?function(a,b,f){return N.apply(a,F.call(arguments,1))}:function(a,b,f){var c=Q(a),d=c.length>>>0,h=0;if(0===d&&1>=arguments.length)throw new TypeError("Array length is 0 and no second argument");for(void 0===f&&(f=(++h,c[0]));h<d;++h)h in c&&(f=b.call(void 0,f,c[h],h,c));return f});X=U?null:function(a,b,f,c){void 0===c&&(c=!0);var h=c;Array.forEach(a,function(a,d){h==c&&(h=!!W(b,f,a,d,this))},a);
return h};Array.every||(Array.every=U?function(a){return U.apply(a,F.call(arguments,1))}:function(a,b,f){return X(a,b,f)});Array.some||(Array.some=ba?function(a){return ba.apply(a,F.call(arguments,1))}:function(a,b,f){return X(a,b,f,!1)});s.forEach=Array.forEach;s.filter=Array.filter;s.reduce=Array.reduce;s.every=Array.every;s.some=Array.some;Array.isArray||(Array.isArray=function(a){return"[object Array]"===O.call(a)});Array.from||(Array.from=function(a){if(a.toArray)return a.toArray();a=Q(a,!0);
var b=a.length>>>0,f;try{f=F.call(a)}catch(c){}if(f&&f.length===b)return f;f=[];for(var h=0;h<b;h++)h in a&&(f[h]=a[h]);return f});Array.of||(Array.of=function(){return F.call(arguments)});s.extend=function(a){var b=1,f=arguments.length,c,h,d;if(f){for(;b<f;b++)if(d=arguments[b])for(h in d)K(d,h)&&(null!==(c=d[h])&&void 0!==c)&&(a[h]=c);return a}s.expand(s.fn,a);return this};s.trim=function(a){return null==a?"":na.call(a)};s.gid=1;s.each=Array.forEach;s.noop=function(a){return a};s.quote=function(a){return(a+
"").replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")};s.callAsync=function(a,b,f,c){c&&clearTimeout(c);return setTimeout(function(){a.apply(b||null,f||[])})};H="&#039; &apos; &#39; &quot; &lt; &gt; &amp; ' ' ' \" < > &".split(" ");for(a=0;14>a;++a)H[a+14]=RegExp(H[a],"g");d.Html||(d.Html={},d.HTML=d.Html);d.Html.escape=n.bind(H,RegExp(H.slice(9,14).join("|")),7,21,0);d.Html.unescape=n.bind(H,RegExp(H.slice(0,7).join("|")),0,14,7);s.inherits=function(a,b,f){a.prototype=Object.create((a.superclass=
b).prototype);a.prototype.constructor=a;Object.isObject(f)&&s.extend(a.prototype,f);return a};ea=L?"add":function(a,b){b=" "+b;return I(a,b+" ")?a:a+b};fa=L?"remove":function(a,b){b=" "+b+" ";return I(a,b)?a.replace(b," "):a};s.prototype=s.fn={constructor:s,ajs:R,attr:function(a,b){var f=this[0],c,h,d;if("string"==typeof a&&void 0===b)return f&&(c=a in f||!("getAttribute"in f)?f[a]:f.getAttribute(a)),c;a=l(a,b);c=0;for(h=this.length;c<h;c++)if(f=this[c])for(d in a)b=a[d],d in f||!("setAttribute"in
f)?f[d]=b:f.setAttribute(d,b);return this},currentStyle:function(a){if(!this[0])return"";var b,f,c;"getComputedStyle"in g?b=g.getComputedStyle(this[0])[a]:(f=this[0].currentStyle,void 0===(b=f[a])&&("font"==a?(b=""+f[a+"Style"],c=f[a+"Variant"],b+=c?" "+c:"",c=f[a+"Weight"],b+=c?" "+c:"",c=f[a+"Size"],b+=c?" "+c:"",c=f.lineHeight,b+=c?"/"+c:"",c=f[a+"Family"],b+=c?" "+c:""):"border"==a&&(b=f[a+"Width"]+" "+f[a+"Style"]+" "+f[a+"Color"])));return b},css:function(a,b){var f=this[0],c,h,d;if("string"==
typeof a&&void 0===b)return(f=f&&f.style&&f.style[a]||void 0)&&C.test(f)&&(f=parseFloat(f)),f;a=l(a,b);c=0;for(h=this.length;c<h;++c)if((f=this[c])&&(f=f.style))for(d in a)b=a[d],""===b||(isNaN(b)||ja[d])||(b+="px"),f[d]=b;return this},size:function(){return this.length},push:function(a,b){if(b){var f=s(a);f.prevObject=this;return f}for(var f=this.length=0,c=a.length;f<c;++f)this[f]=a[f],this.length++;return this},each:function(a){for(var b=0,f=this.length,c;b<f;++b)a.call(c=this[b],b,c,this);return this},
eq:function(a){return this.push(this[a],1)},filter:function(a){a=a.split(".");return this.push(k(this,a[0],a[1]),1)},find:function(a){return this.push(y(this,a),1)},children:function(a){if(this[0]){var b=this[0].childNodes;return this.push(void 0===a?b:b[a],1)}return this.push(0,1)},end:function(){return this.prevObject||s()},parent:function(){var a=this[0],b=a&&a.parentElement||null;if(a&&!("parentElement"in a)&&!b)for(b=a&&a.parentNode;b&&1!=b.nodeType;)b=b.parentNode;return this.push(b,1)},html:function(a){return void 0===
a?this[0]&&this[0].innerHTML:this.each(function(){this.innerHTML=a})},val:function(a){if(void 0===a)return this[0]&&this[0].value||"";for(var b=this.length,f;b--;)if(f=this[b])f.value=a,f.setAttribute("value",a);return this},append:function(a){var b=this[0];b&&b.appendChild(u(arguments));return this},prepend:function(a){var b=this[0];b&&b.insertBefore(u(arguments),b.firstChild);return this},after:function(a){var b=this[this.length-1];b&&b.parentNode&&b.parentNode.insertBefore(u(arguments),b.nextSibling);
return this},before:function(a){var b=this[0];b&&b.parentNode&&b.parentNode.insertBefore(u(arguments),b);return this},remove:function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})},bind:function(a,b){return c(this,1,a,b)},unbind:function(a,b){return c(this,0,a,b)},trigger:function(a){return this.each(function(){try{this[a]()}catch(b){console.log&&console.log(this,a)}})},one:function(a,b){return this.bind(a,function T(){s(this).unbind(a,T);return b.apply(this,arguments)}.bind(this))},
hasClass:function(a){a=A.bind(null,a.replace(x," ").split(z));return"length"in this?Array.some(this,a):a(this)},addClass:function(a){return p.call(this,ea,a)},removeClass:function(a){return p.call(this,fa,a)},toggleClass:function(a,b){var f="length"in this&&!("nodeType"in this)?this:[this];return((void 0===b?!s.fn.hasClass.call(f,a):b)?s.fn.addClass:s.fn.removeClass).call(f,a)},hasMod:function(a){if(!a)return!1;a=function(a){return a.className&&this.test(a.className)}.bind(RegExp("(_"+a.trim().replace(/\s/g,
" _")+"(\\s|$))","g"));return"length"in this&&!m(this)?Array.some(this,a):a(this)},addMod:function(a){return p.call(this,function(a,b){a&&!I(a,b)&&(a=a.trim(),a+=" "+a.replace(/(\s|$)/g,b+"$1"));return a},"_"+a.trim().replace(/\s/g," _"))},removeMod:function(a){return p.call(this,function(a,b){a&&I(a,b)&&(a=a.trim(),a=" "+a.replace(RegExp("(\\s|^)[\\w-_]+"+b+"(?=\\s|$)","g"),""));return a.trim()},"_"+a.trim().replace(/\s/g," _"))},toggleMod:function(a,b){var f="length"in this&&!("nodeType"in this)?
this:[this];return((void 0===b?!s.fn.hasMod.call(f,a):b)?s.fn.addMod:s.fn.removeMod).call(f,a)},closest:function(a,f){var c=this[0],h;f&&!m(f)&&(f=null);if(c){a=a.split(".");h=a[0]?a[0].toUpperCase():!1;a=a[1]?a.slice(1):!1;do if(m(c)&&!(h&&c.tagName.toUpperCase()!=h||a&&!A(a,c)))return this.push(c,1);while(c&&(!f||f!=c)&&(c=c.parentNode)&&c!==b.body)}return this.push(void 0,1)},show:function(){var a=this.css("display");return"none"==a?this.css("display",""):a},hide:function(){return this.css("display",
"none")},toggle:function(a){void 0===a&&(a="none"==this.css("display"));return this[a?"show":"hide"]()},add:function(a,b){var f=s(a),c=0,h=this.length,d;b&&(f=f.filter(b));for(d=f.length;c<d;++c)this[c+h]=f[c];this.length+=d}};Array.forEach(["add","remove","has","toggle"],function D(a,b,f,c){var h=a+(c||"Class");h in this.fn&&(this[h]=V.bind(s.fn[h]));c||D.call(this,a,b,f,"Mod")},s);s.get=function S(a,f){S._$_head||(S._$_head=s("head"));var c="ajs__jsonp__"+s.gid++,h=b.createElement("script");h.type=
"text/javascript";h.src=a+"&callback="+c;g[c]=function(a){f(a);g[c]=null;try{delete g[c]}catch(b){}setTimeout(s.fn.remove.bind(s(h)))};setTimeout(s.fn.append.bind(S._$_head,h))};s.getCaretPosition=function(a,f){if(!f||a==b.activeElement){var c=(a.nodeName||"").toUpperCase(),h,d,g,k;if("INPUT"==c||"TEXTAREA"==c){if("selectionStart"in a)return{start:+a.selectionStart||0,end:+a.selectionEnd||0};if(b.selection)return(c=b.selection.createRange())&&c.parentElement()==a&&(h=a.value,g=h.length,k=h.replace(/\r\n/g,
"\n"),d=a.createTextRange(),d.moveToBookmark(c.getBookmark()),c=a.createTextRange(),c.collapse(!1),-1<d.compareEndPoints("StartToEnd",c)?h=g:(h=-d.moveStart("character",-g),h+=k.slice(0,h).split("\n").length-1,-1<d.compareEndPoints("EndToEnd",c)||(g=-d.moveEnd("character",-g),g+=k.slice(0,g).split("\n").length-1))),{start:h,end:g}}}};s.setCaretPosition=function T(a,b,f){if(!m(a)&&a&&"length"in a)Array.forEach(a,function(a){T(a,b,f)});else if(a==document.activeElement)if(1==arguments.length?(b=0,f=
a.value.length):2==arguments.length&&(f=b),a.setSelectionRange)a.setSelectionRange(b,f);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0);c.moveEnd("character",f);c.moveStart("character",b);c.select()}};var ga=L?null:function(a,b){return I(a," "+b+" ")};s.__processHandler=function(a){return"object"===typeof a?a.handleEvent:a};var ia=/\[native\s+code\]/i.test(b.getElementsByClassName)?function(a,b){return b.getElementsByClassName(a)}:function(a,b){return k(b[B]("*"),null,a)};s.support=
{oninput:"oninput"in b};s._random_string_=R;s.own=K;"ui"in d||(d.ui={});d.browser||(d.browser={});f?d.browser.msie=f:(a=g.opera)&&"function"==typeof(a=a.version)&&(d.browser.opera=+a());d.$=s;if(!g.CSS||!g.CSS.supports)if(g.CSS||(g.CSS={}),!g.CSS.supports&&g.supportsCSS)g.CSS.supports=g.supportsCSS.bind(g);else{var Y={};g.CSS.supports=function(a,b,f,c,h){var d=c+"\\/"+h;if(d in Y)return Y[d];if(5>arguments.length)throw Error("WRONG_ARGUMENTS_ERR");var g=(c+"").replace(this,f),k=c&&h&&g in b.style;
if(k)if(a)if(/\(|\s/.test(h))try{b.style[g]=h,k=!!b.style[g]}catch(l){k=!1}else b.style.cssText="display:none;height:0;width:0;visibility:hidden;position:absolute;position:fixed;"+c+":"+h,document.documentElement.appendChild(b),k=b.currentStyle[g]==h,document.documentElement.removeChild(b);else b.style.cssText=c+":"+h,k=b.style[g]==h;b.style.cssText="";return Y[d]=k}.bind(/(-)([a-z])/g,f&&10>f,g.document.createElement("_"),function(a,b,f){return f.toUpperCase()})}f=a=H=n=null}.call(this);
void function(u,n){"use strict";function p(){this._asynchMarkers={}}var A=1,m=n._random_string_,e="uuid"+m,r=n.own,E="noprop_"+e,q=["target","preventDefault","isDefaultPrevented","stopImmediatePropagation"],c=Object.isPlainObject,l=n.extend,y=n.__processHandler;l(p.prototype,{constructor:p,buildClassName:function(c,g){g=g||this.$Elm;var d,a,b;-1!=(b=c.indexOf("&"))&&(c=!(d=g.selector)||"."!==(a=d.charAt(0))&&"#"!==a?"":(0<b?c.substr(0,b):"")+d.substr(1)+c.substr(b+1));return c},findSub:function(c){var g=this.$Elm,
d;"string"===typeof c&&((d=c.charAt(0))&&("."!==d&&"#"!==d&&"["!==d)&&(c="."+c),c=this.buildClassName(c));return new n(c,g)},hasTrigger:function(c){var g=this._,d;if(g&&(d=g.__events__))for(c=c.toUpperCase().split(" ");g=c.pop();)if(g in d)return!0;return!1},addTrigger:function(c,g){var d=this._,a;if(g)for(d||(d=this._={}),c=c.toUpperCase().split(" "),(a=d.__events__)||(a=d.__events__={});d=c.pop();)d=a[d]?a[d]:a[d]={},(g[e]||!(g[e]=m+ ++A))&&g[e]in d||(d[g[e]]=g);return this},removeTrigger:function(c,
g){var d=this._,a;if(!(d&&g&&g[e]&&(a=d.__events__)))return this;for(c=c.toUpperCase().split(" ");d=c.pop();)(a=a[d])&&g[e]in a&&delete a[g[e]];return this},fireTrigger:function(k){var g=this,d=g._,a,b,f,h=(f=k&&"object"==typeof k)&&k.type||k,C,z=!1,x=!1,t,e=!0,d=!d||!(a=d.__events__)||!h||!(a=a[h.toUpperCase()]);(t=this._nextTriggerOptions)&&h in t&&(f&&l(k,t[h]),delete t[h]);if(d)return e;f||(k={type:k});if(void 0===k.name||void 0===k.namespace)t=h.split(":"),k.name||(k.name=t[1]||t[0]),k.namespace||
(k.namespace=t.length?t[0]:"");t=Array.reduce(q,function(a,b){a[b]=b in k?k[b]:E;return a},{});k.currentTarget=k.target=this;C=k.preventDefault;k.preventDefault=function(){C&&C.apply(this.context,arguments);z=!0};k.isDefaultPrevented=function(){return z};k.stopImmediatePropagation=function(){t.stopImmediatePropagation?t.stopImmediatePropagation.apply(this.context,arguments):this.stopPropagation&&this.stopPropagation();x=!0};for(b in a)if(r(a,b)&&(f=a[b],"object"===typeof f&&(g=f),(f=y(f))&&!1===(e=
f.call(g,k))&&k.preventDefault(),x))break;!1!==e&&k.isDefaultPrevented()&&(e=!1);Array.reduce(q,function(a,b){a[b]===E?delete k[b]:k[b]=a[b];return a},t);if(c(d=k.nextTriggerOptions))for(b in(t=this._nextTriggerOptions)||(t=this._nextTriggerOptions={}),d)r(d,b)&&c(g=d[b])&&(t[b]||(t[b]={}),l(t[b],g));t=k=f=g=x=z=h=f=a=d=null;return!1!==e},_callAfterTrigger:function(c){return this.fireTrigger(c,c.type+":AFTER")},disable:function(){this.__disabled=!0},enable:function(){this.__disabled=!1},_callTriggerFunctionAsync:function(){var c=
this.currentTarget;if(!1!==this.result&&(!0===this.async&&c._asynchMarkers&&this._asynchMarker===c._asynchMarkers[this.type])&&c instanceof p&&(c._asynchMarkers[this.type]=null,this.type in c))c[this.type](this)}});u.ui||(u.ui={});u.ui.ajsUIComponent=p}.call(null,this.ajs,this.ajs.$);
void function(u,n,p){"use strict";function A(e,r){if(!(this instanceof A))return new A(e,r);e=p(e);if(1<e.size())return Array.reduce(e,function(e,q,c){c&&e.push(new A(q,r));return e},[this]);this.opts=r=p.extend({cnLink:"js-link",cnMenu:"js-menu",cnSection:"js-section",cnExpand:"js-expand",cnHover:"js-hover",cnIndex:0,onselect:p.noop,timeout:1500,hideByClick:!0,autoPos:!1},r);this.$Elm=e;this.$Link=this.findSub(r.cnLink).bind("click mouseout mouseover blur keyup",this).attr("unselectable","off").css({userSelect:"none",
MozUserSelect:"none",WebKitUserSelect:"none",OUserSelect:"none",MSUserSelect:"none"});!1!==r.tabIndex&&this.$Link.attr("tabIndex",n.ui.tabIndex++);this.$Link.find("*").attr({unselectable:"off"});this.$Menu=this.findSub(r.cnMenu).bind("click mouseout mouseover mousedown mouseup",this);this.$Menu.__Sections=this.findSub(r.cnSection);0<=r.cnIndex&&this._onSelect({},this.$Menu.__Sections[r.cnIndex]);Array.forEach(["cnSectionHover","cnSectionExpand"],function(e){var q=this.opts[e];q&&(this.opts[e]=this.buildClassName(q))},
this)}var m=p(u);p.inherits(A,n.ui.ajsUIComponent,{handleEvent:function(e,r){if(!this.__disabled){var m=this.opts,q=e.currentTarget,c=this.$Menu[0],l=this.$Link[0],y;clearTimeout(this._tid);r=r||e.type;switch(r){case "keyup":q===l&&(m=e.keyCode,40==m||38==m||13==m)&&(this.expanded()?13==m?(this._onSelect(e),this._expand(!1)):this._move(40==m?1:-1):13==m&&this.handleEvent(e,"keyup.click"));break;case "blur":this.__down||(q=e.explicitOriginalTarget||u.activeElement,1!=q.nodeType&&(q=q.parentNode),this._hitTest(q)||
this._expand(!1));break;case "click":if(q!==document){if(void 0!=e.detail&&0==e.detail){e.preventDefault();break}if(1<e.which){y=!0;break}}case "keyup.click":q===l?e.preventDefault():q!==document&&this._onSelect(e);if(m.hideByClick||!this._hitTest(e))this._expand(!this.expanded()),y=!0;break;case "mouseup":case "mousedown":this.__down="mousedown"===r;y=!0;break;case "mouseover":q=e.target;do if(p.fn.hasClass.call(q,"js-section")){this._move(q);break}while(q!==c&&q!==l&&(q=q.parentNode));y=!0;break;
case "mouseout":0<m.timeout&&(this._tid=setTimeout(this._expand.bind(this,!1),m.timeout))}y||e.stopPropagation()}},_onSelect:function(e,p){(p||(p=this.$Menu.find("."+this.opts.cnHover)[0]))&&this.opts.onselect.call(this,e,p)},_move:function(e){var m=this.$Menu.__Sections,n=this.opts.cnHover,q=-1;m&&m.length&&(m.each(function(c,l){l=p(l);l.hasClass(n)&&(q=c,l.removeClass(n))}),e&&(e.tagName?p(e).addClass(n):(-1!=q&&(q+=e),m[q]||(q=~e?0:m.length-1),m.eq(q).addClass(n))))},_hitTest:function(e){return!!p(e.target||
e).closest("."+this.opts.cnMenu).size()},_expand:function(e){this.$Elm.toggleClass(this.opts.cnExpand,e);var p=this.$Menu,n,q,c;p.toggle(e);this.opts.autoPos&&(this.$Link[0]&&p[0])&&(e&&(n=this.$Link[0].getBoundingClientRect(),q=p[0].getBoundingClientRect(),c=n.height||n.bottom-n.top),p.css({marginLeft:e?n.left-q.left+"px":0,marginTop:e?n.top+c-q.top+"px":0}));m.unbind("click",this);e&&(this._move(),setTimeout(function(){m.bind("click",this)}.bind(this),0))},expanded:function(){return this.$Elm.hasClass(this.opts.cnExpand)}});
n.ui.tabIndex=n.ui.tabIndex||1;n.ui.dropdown=A}.call(null,this.document,this.ajs,this.ajs.$);
void function(u,n,p){"use strict";function A(c){document.activeElement!=this&&(this.setAttribute("data-prevent-event-focus",1),this.focus());void 0!=c&&n.$.setCaretPosition(this,this.value.length)}function m(c,l,e){void 0===E&&(E=CSS.supports("clip","auto")?"auto":"rect(auto,auto,auto,auto)");if(!l.items)return null;if(!(this instanceof m))return new m(c,l);c=p(c);if(1<c.size())return Array.reduce(c,function(c,d,a){a&&c.push(new m(d,l));return c},[this]);this.opts=l=p.extend({cnForm:"js-form",deleteName:!0,operandClassWrapperMenu:"w-portal-menu__search__operands__menu",
operandClassWrapperInput:"w-portal-menu__search__operands__input"},l);this.$Elm=c;c.bind("scroll",this);c.find(".w-portal-menu__search__operands__width_outer").bind("scroll",this);c.find(".w-portal-menu__search__operands__width_inner").bind("scroll",this);this.$Input=this.$original_Input=e;this.$Input.bind(r,this);this.operandsKeysString="";this.operandsKeys={};this.operandsNames={};this.operands={};this.operandsTabIndex={};var k=!this.opts.order;k&&(k=this.opts.order={});Array.forEach(Object.keys(this.opts.items),
function(c,d){var a=this.opts.items[c];c=c.toUpperCase();this.operandsKeys[c]=a;this.operandsNames[a]=c;this.operands[a]=void 0;this.operandsTabIndex[a]=n.ui.tabIndex++;this.operandsKeysString+="|"+c+"|";k&&(k[c]=d)},this);this.operandsKeysString=this.operandsKeysString.toUpperCase();this.operandsKeysOrder={};this.operandsNamesOrder={};Array.forEach(Object.keys(this.opts.order),function(c){var d=this.opts.order[c];c=c.toUpperCase();this.operandsNamesOrder[this.operandsKeys[c]]=this.operandsKeysOrder[c]=
d},this)}var e=n.browser.msie,r=p.support.oninput&&(!e||9<e)?"input":"input keypress keyup",E,q=p.own;p.inherits(m,n.ui.ajsUIComponent,{handleEvent:function(c){if(!this.__disabled){var l=c.type;if(r.contains(l))return l=c.keyCode,8==l||46==l||37==l||39==l?void 0:this._operandsInput(c);if("click"==l&&"LABEL"==(c.currentTarget.nodeName+"").toUpperCase())return this._operandLabelClick(c);if("scroll"==l)return this.horisontalScroll(c),this._checkLabelsPosition(c),!1;var e,k=p(c.target),g,d,a="data-prev-operand";
if("keydown"==l){g=k.attr("data-operand");d=this.operands[g];l=c.keyCode;if(!d||!l)return;e=p.getCaretPosition(c.target,!0);if(37==l&&0===e.end||39==l&&e.start===k[0].value.length&&(a="data-next-operand")){if(k=k.attr(a),k=this.operands[k])this._currentOperandObject=d,c.preventDefault(),this.selectOperand(k,"data-next-operand"!=a?-1:0),d=k}else 8==l&&0===e.start&&0===e.end?(this._currentOperandObject=d,c.preventDefault(),this.deactivateOperand(g),d=null):8!=l&&46!=l||(!1!==d.stable||!(0===e.start&&
e.end===c.target.value.length||8==l&&1===e.start&&1===e.end))||(c.target.value="",this._currentOperandObject=d,c.preventDefault(),this.deactivateOperand(g),d=null)}else"keyup"==l&&(g=k.attr("data-operand"),d=this.operands[g]);d&&this._checkOperandCaretPosition(d)}},setActiveInput:function(c,l){this.$Input!==c&&this.fireTrigger({type:"operands:activeInputChange",oldInput:this.$Input,newInput:c,isOperandInput:!!c.attr("data-operand"),isNewOperand:l||!1})&&(this.$Input=c)},getCurrentOperand:function(){return this._currentOperandObject},
createOperands:function(c,l,y,k,g){k=void 0==k?1:k;c=c.toUpperCase();var d=this.opts,a=this.$Elm,b=d.operandClassWrapperMenu,f=d.operandClassWrapperInput,h,C,z,x=this.operandsKeys[c],t=this.operandsNamesOrder[x],m=this.$Input[0].getAttribute("data-operand");if(x){z=this.$Input;(d=this.operands[x])?(f=d.$Input,a.css("display","")):(C=a.find("."+f+"_"+x),f=C.find(".portal-menu__search__operands__input__field").attr({tabIndex:this.operandsTabIndex[x]}),a.css("display",""),a=a.find("."+b+"_"+x).css("display",
""),d=this.operands[x]=new n.ui.dropdown(a.find(".portal-menu__search__operands__menu"),{cnLink:"portal-menu__search__operands__menu__button",cnMenu:"portal-menu__search__operands__menu__dropdown",cnExpand:"portal-menu__buttons__item_open",cnHover:"portal-menu__buttons__item_hover",cnIndex:t,timeout:0,tabIndex:!1,autoPos:!0,onselect:function(a,b,c){(b=c&&c.getAttribute("data-operand-name"))&&b!==a&&(c=this.operands[a],((a=this.operands[b])&&!a.isActive||!a&&b in this.operands)&&this.createOperands(this.operandsNames[b],
"",void 0,0),this.deactivateOperand(c.operandName,void 0,a))}.bind(this,x)}),p.bind("labels"in f[0]?f[0].labels[0]:f.closest("label")[0],"click",this),f.bind("focus",this.operandsFocus.bind(this,f,d)).bind(r,this.updateOperandWidth.bind(this,d,null)),b=r+(r.contains("keydown")?"":" keydown"),b+=b.contains("keyup")?"":" keyup",f.bind(b,this),d.operandName=x,d.operandKey=c,d.InputWrapper=C,d.MenuWrapper=a,d.$Input=f,d.$Input.attr("data-operand",x),d.ElementForHeight=p("<span></span>").css({position:"fixed",
top:"-10000px",left:"-10000px",visibility:"hidden",font:d.$Input.currentStyle("font"),padding:d.$Input.currentStyle("padding"),border:d.$Input.currentStyle("border")}),p(u.body).append(d.ElementForHeight));f[0].name=f.attr("data-input-name");d.isActive=!0;d.stable=!0!==g;z.attr("data-operand")?void 0!=y&&(z[0].value=y):(this.opts.deleteName&&(this.$original_Input.__name=this.$original_Input[0].name),this.$original_Input.__value=this.$original_Input[0].value,this.opts.deleteName&&(this.$original_Input[0].name=
""),this.$original_Input[0].value="",this.$original_Input.attr("readonly","true"),this.$original_Input.css("visibility","hidden"),this.$original_Input.attr("data-allow-empty-value","true"));if(z!=d.$Input){if(c=z[0].getAttribute("data-next-operand"))h=this.operands[c],h.$Input.attr("data-prev-operand",x);z!=this.$original_Input&&z.attr("data-next-operand",x);m&&(h=this.operands[m])!=d&&(f.attr("data-prev-operand",m),h.InputWrapper.after(d.MenuWrapper[0]),d.MenuWrapper.after(d.InputWrapper[0]),c?f.attr("data-next-operand",
c):f[0].removeAttribute("data-next-operand"))}d.MenuWrapper.css("display","");d.InputWrapper.css("display","");8>e&&(b=d.MenuWrapper[0].className,d.MenuWrapper[0].className="",d.MenuWrapper[0].className=b);void 0!=l&&(f[0].value=l);(h=this.operands[z[0].getAttribute("data-operand")])&&this.updateOperandWidth(h);this.updateOperandWidth(d);this._checkLabelsPosition();this.setActiveInput(f,!0);0<k&&(2==k&&f.attr("data-prevent-event-focus",1),f[0].focus(),e||n.browser.opera?void 0!=l&&n.$.setCaretPosition(f[0],
l.length):this.__asyncFocusHandler=p.callAsync(A,f[0],[l],this.__asyncFocusHandler));return this._currentOperandObject=d}},deactivateOperand:function(c,l,e){l=void 0==l?1:l;var k,g,d,a,b;if(c=this.operands[c])this._resetLabelsPosition(c),this._currentOperandObject=null,b=c.$Input==this.$Input,a=c.$Input.val(),g=c.$Input[0].getAttribute("data-next-operand"),d=c.$Input[0].getAttribute("data-prev-operand"),this.opts.deleteName&&(c.$Input[0].name=""),c.$Input[0].removeAttribute("data-next-operand"),c.$Input[0].removeAttribute("data-prev-operand"),
c.$Input[0].name="",c.$Input.val(""),g||d||e?(g&&(k=this.operands[g])&&(d?k.$Input[0].setAttribute("data-prev-operand",d):k.$Input[0].removeAttribute("data-prev-operand")),d&&(k=this.operands[d])?(g?k.$Input[0].setAttribute("data-next-operand",g):k.$Input[0].removeAttribute("data-next-operand"),b&&(e||(e=k))):b&&(e||(e=this.operands[g])),e&&this.setActiveInput(e.$Input)):(this.$Elm.css("display","none"),b&&this.setActiveInput(this.$original_Input),this.opts.deleteName&&(this.$Input[0].name=this.$original_Input.__name),
this.$Input[0].removeAttribute("readonly"),this.$Input.css("visibility",""),this.$original_Input[0].removeAttribute("data-allow-empty-value"),this.Suggest&&this.Suggest.applyToInput(this.$Input)),this.$Input[0].value=a&&this.$Input[0].value?this.$Input[0].value+" "+a:this.$Input[0].value||a||"",0<l&&(2==l&&this.$Input.attr("data-prevent-event-focus",1),this.__asyncFocusHandler=p.callAsync(this.$Input[0].focus,this.$Input[0],null,this.__asyncFocusHandler),p.setCaretPosition(this.$Input[0],this.$Input[0].value.length)),
c.MenuWrapper.css("display","none"),c.InputWrapper.css({display:"none",width:"","min-width":""}),e&&(e.isActive||this.createOperands(e.operandKey),this.updateOperandWidth(e),this.selectOperand(e,e.operandName==d?-1:0,0==l)),c.stable=c.isActive=!1},getOperandByKeyOrName:function(c){var l=c;return"object"==typeof l&&l||((l=this.operands[c])||(l=this.operands[this.operandsKeys[c]]))&&l},getOperandKeyByKeyOrName:function(c){return c in this.operandsNames?this.operandsNames[c]:c in this.operandsKeys?c:
null},getOperandValue:function(c){return(c=this.getOperandByKeyOrName(c))&&c.$Input.val()},setOperandValue:function(c,l,e,k){null==l&&(l="");var g=this.getOperandByKeyOrName(c);if(g)if(""===l){if(!e&&g.isActive)return g.$Input.val(l),this.deactivateOperand(g.operandName,0),l}else"none"!=g.MenuWrapper.css("display")||k||(g=this.createOperands(g.operandKey,void 0,void 0,0));else if(!g){if(!(c=this.getOperandKeyByKeyOrName(c)))return;if(""!==l||e)g=this.createOperands(c,l,void 0,0)}g&&(g.$Input.val(l),
this.updateOperandWidth(g));return l},operandsFocus:function(c,l){this._currentOperandObject=l;this.setActiveInput(c)},updateOperandWidth:function(c,l){var e="input"==r?10:20,k,g,d,a;if(c||(c=this._currentOperandObject))g=c.$Input,l=l||g[0].value,d=g[0].getAttribute("data-next-operand"),c.ElementForHeight.html(n.Html.escape(l)),k=c.ElementForHeight[0].clientWidth,22>k&&(k=22),k+=e,d?(e="width",d="minWidth"):(e="minWidth",d="width"),c.InputWrapper.css(e)!=k&&(k+="px",c.InputWrapper.css(e,k),g.css(e,
k),a=!0),c.InputWrapper.css(d)&&(c.InputWrapper.css(d,""),g.css(d,""),a=!0),a&&this._checkLabelsPosition()},selectOperand:function(c,l,e){e||(c.$Input[0].focus(),this.Suggest&&this.Suggest.applyToInput(c.$Input));void 0!==l&&(0>l&&(l=c.$Input.val().length),p.setCaretPosition(c.$Input[0],l));this._checkLabelsPosition();this._currentOperandObject=c},_operandLabelClick:function(c){this.__disabled||(this.$Input[0].focus(),c.preventDefault())},_operandsInput:function(){if(!this.__disabled){var c=this.$Input[0].value,
l,e=c.lastIndexOf(":"),k,g,d=0,a,b,f,h,C,z;h={type:"operands:find",input:this.$Input[0],inputValue:c,newOperand:null,lastPrefixIndex:e,currentOperand:this.$Input.attr("data-operand")||null};if(!1!==this.fireTrigger(h)){c=h.inputValue;k=e=h.lastPrefixIndex;if(a=h.newOperand)b=a,a=this.operandsNames[a];h.currentOperand&&this.$Input.oldValue!==c&&(f=!0,this.$Input.oldValue=c);if(!a&&0<=k){l=c.toUpperCase();for(z=this.operandsKeysString;~(g=z.indexOf(l.substr(--e,k-e),d));)if(124===z.charCodeAt(g+(k-
e)))if(a=l.substr(e,k-e),124===z.charCodeAt(g+(k-e)-a.length-1)){1>e||/\s/.test(l.charAt(e-1))||(a="");break}else a="";else d=g;h.newOperand=a}if(a&&(b||(b=this.operandsKeys[a]),b&&(b in this.operands&&(!this.operands[b]||!this.operands[b].isActive))&&(h.type="operands:activate",h.leftPart=c.substring(0,e).trim(),h.rightPart=c.substring(k+1).trim(),!1!==this.fireTrigger(h))))return""==h.leftPart+h.rightPart&&this._currentOperandObject&&(C=this._currentOperandObject.operandName),c=this.createOperands(a,
h.rightPart,h.leftPart),C&&this.deactivateOperand(C),c;f&&this._checkLabelsPosition()}}},horisontalScroll:function(c){if(!this.__disabled){var e=c.target;this.__scrollContainer||(this.__scrollContainer=e);e.scrollTop=0;c.preventDefault();c.stopPropagation();return!1}},_resetLabelsPosition:function(c){c&&(c.$Elm.css({width:"",height:""}),c.$Link.css({position:"",top:"auto",left:"auto",clip:E}))},_checkLabelsPosition:function(){if(!this.__disabled){var c,e,p,k=this.operands,g=this.$Elm[0].getBoundingClientRect(),
d,a,b,f,h,C=E,z;for(e in k)if(q(k,e)&&(p=k[e])&&p.isActive&&p.$Input){if(c=p.$Input[0]){h=p.$Link[0];z=c;var x=!0;f=void 0;f=p.$Elm[0].getBoundingClientRect();f.left>g.left&&(x=!1);x?(d||(d=z.getBoundingClientRect()),d.right<=g.left?d=!1:(b||(b=h.getBoundingClientRect()),z=b.width||b.right-b.left,f=d.right-30-(g.left+z),d=x=0>f?-f:0)):d=!1;if(!1!==(h=d))break;else d=b=null}c=void 0}this.__prevPositioned_operandObject&&void 0!==c&&this.__prevPositioned_operandObject.$Input[0]!=c&&this._resetLabelsPosition(this.__prevPositioned_operandObject);
c&&(a=p.$Elm)&&(!h||0>h?h=0:(z=b.width||b.right-b.left,C=b.height||b.bottom-b.top,C=["0px",z+"px",C+"px",h+"px"],C="rect("+C.join(",")+")"),e=p.$Link,c.getBoundingClientRect(),a.css({width:e[0].clientWidth,height:e[0].clientHeight}),e.css({position:"absolute",top:0,left:0-h,clip:C}),this.__prevPositioned_operandObject=p)}},_checkOperandCaretPosition:function(c){if(c&&this.__scrollContainer){var e=this.__scrollContainer,m=c.$Input[0],k=m.value;if(k){var g=m.getBoundingClientRect(),d=c.$Link[0].getBoundingClientRect();
g.left>=d.right||(m=p.getCaretPosition(m),k=k.substr(0,m.end),c.ElementForHeight.html(n.Html.escape(k)),c=c.ElementForHeight[0].clientWidth+g.left-(k?10:0),c<d.right&&(g=d.width||d.right-d.left,d=c-(d.left+g),0>d&&(e.scrollLeft+=d)))}}}});n.ui.tabIndex=n.ui.tabIndex||1;n.ui.operands=m}.call(null,this.document,this.ajs,this.ajs.$);
void function(u,n,p){"use strict";function A(m,e){if(!(this instanceof A))return new A(m,e);m=p(m);if(1<m.size())return Array.reduce(m,function(p,c,l){l&&p.push(new A(c,e));return p},[this]);this.opts=e=p.extend({cnForm:"js-form",cnInput:"js-input",cnBlur:"js-blur",cnPlaceholder:"js-placeholder",cnSection:"js-section",cnSectionTxt:"js-section-text",cnSectionLink:"js-section-link",cnSectionMenu:"js-section-menu",cnSectionHover:"js-section-hover",cnSectionExpand:"js-section-expand",cnSectionSelected:"js-section-selected",
paddingRight:35,searchInputResize:!0,useOperands:!1,autoTabIndex:!0},e);this.$Elm=m;this.$Form=this.findSub(e.cnForm).bind("submit",this);this.$Placeholder=this.findSub(e.cnPlaceholder);this.$Input=this.findSub(e.cnInput).bind("focus blur",this);e.autoTabIndex&&this.$Input.attr({tabIndex:n.ui.tabIndex++});this.$Section=this.findSub(e.cnSectionTxt);var r=this.findSub(e.cnSectionLink),E=e.newSubElementsLogic?r:this.$Elm;r.size()&&(this.Sections=new n.ui.dropdown(E,{cnLink:r,cnMenu:e.cnSectionMenu,cnHover:e.cnSectionHover,
cnExpand:e.cnSectionExpand,cnIndex:e.cnSectionIndex,onselect:this._section.bind(this)}));m.find("input").each(function(){"submit"==this.type&&(this.tabIndex=n.ui.tabIndex++)});e.suggest&&(this.Suggest=n.ui.suggest(m,e.suggest));e.operands&&((this.$Operands=new n.ui.operands(this.$Elm.find(".w-portal-menu__search__operands"),e.operands,this.$Input)).addTrigger("operands:activeInputChange",function(e){this.$Input=e.newInput;this.Suggest&&this.Suggest.applyToInput(this.$Input,e.isNewOperand);this.isPlaceholder=
!e.isOperandInput;this._placeholderCheck()}.bind(this)),this.Suggest&&this.Suggest.addTrigger("suggests:mark",function(e){if(e.updateInputValue){var c=e.newSuggestNode,l=e.oldSuggestNode,p=e.newSuggest,c=c&&c.getAttribute("data-search-name"),k,g=this.getCurrentOperand();g&&g.stable||(l&&c!=(k=l.getAttribute("data-search-name"))&&k&&this.deactivateOperand(k,!0),c&&(this.createOperands(this.getOperandKeyByKeyOrName(c),"","",2,!0),g=this.getCurrentOperand(),g.__onblue||(g.__onblue=function(){g.stable=
!0},g.$Input.bind("blur",g.__onblue))));this._checkLabelsPosition();this.updateOperandWidth(void 0,e.updateInputValue?p:void 0)}}.bind(this.$Operands)).addTrigger("suggests:select",function(e){var c=this.getCurrentOperand();c&&c.stable||(c.stable=!0);this._checkLabelsPosition();this.updateOperandWidth(void 0,e.updateInputValue?newSuggest:void 0)}.bind(this.$Operands)));this._placeholderCheck=this._placeholderCheck.bind(this);setTimeout(this._placeholderCheck);p(u).bind("DOMContentLoaded",this._placeholderCheck);
p(window).bind("load",this._placeholderCheck);this.isPlaceholder=!0;this._section({});this.isReady=!0;Array.forEach(["cnBlur","cnSection"],function(e){var c=this.opts[e];c&&(this.opts[e]=this.buildClassName(c))},this)}p.inherits(A,n.ui.ajsUIComponent,{handleEvent:function(p,e){var n=this.isEmpty(),u;switch(e||p.type){case "submit":n&&(this.$Input.trigger("focus"),p.preventDefault());break;case "blur":u=n;default:this.$Elm.toggleClass(this.opts.cnBlur,!(!u||!this.isPlaceholder)),u&&this.val("")}},
_placeholderCheck:function(m){m=m&&m.type;"DOMContentLoaded"===m?(p(u).unbind("DOMContentLoaded",this._placeholderCheck),setTimeout(this._placeholderCheck,20)):"load"===m?(p(window).unbind("load",this._placeholderCheck),setTimeout(this._placeholderCheck,20)):"unknown"!=typeof u.activeElement&&this.$Input[0]===u.activeElement||this.handleEvent({type:"blur"})},_section:function(m,e){var n=this.opts,u=e||m.target,q=n.cnSectionSelected,c=p(u).closest("."+n.cnSection),n=this.findSub(n.cnSection);u&&(n.filter("."+
q).removeClass(q),c.addClass(q));(c=n.filter("."+q))[0]&&(this.$Form.attr({action:c.attr("data-action"),target:c.attr("data-target")||"_self"}),this.$Input.attr("name",c.attr("data-input-name")),this.$Section.html(c.html()),this.Suggest&&this.Suggest.set("ajaxUrl",c.attr("data-suggest-url"),!this.isReady));m&&m.preventDefault&&("click"!=m.type&&13!=m.keyCode||this.$Input.trigger("focus"),m.preventDefault())},isEmpty:function(){return""==this.val()},val:function(m){var e;return void 0!==m?(e=this.__val!=
m,this.$Input.val(m),this.__val=m,e&&this._placeholderCheck(),this):p.trim(this.$Input.val())},getSuggest:function(){return this.Suggest},setPlaceholder:function(p){this.$Placeholder.html(p)},disable:function(){this.$Operands&&this.$Operands.disable();this.Suggest&&this.Suggest.disable();this._placeholderCheck()},enable:function(){this.$Operands&&this.$Operands.enable();this.Suggest&&this.Suggest.enable();this._placeholderCheck()}});n.ui.tabIndex=n.ui.tabIndex||1;n.ui.search=A}.call(null,document,
this.ajs,this.ajs.$);
void function(u,n,p){"use strict";function A(a){return String(a||"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function m(){}function e(a,b){b.data=a.call(this,b.data,b.findValue,b)}function r(a,b,c){var h=c.findLastWord;return c.searchLast?a="function"===typeof h&&!h.test&&h.call?h.call(this,b,this):b.replace(h,""):a}function E(a,b,c){if(!c.searchLast)return b;c=this.__prevSuggest;b=p.trim(b.replace(RegExp(A(c&&c.val||"")+"$"),"")+this.__val).replace(/\S+$/,"")+""+(c.val=a);""!=b&&(b+="");return b}function q(a,
b){if(!(this instanceof q))return new q(a,b);q.superclass.apply(this);a=p(a,void 0);1<a.size()&&(this.__others=Array.reduce(a,function(a,c,f){f&&a.push(new q(c,b));return a},[this]));this.__prevSuggest={};this.__expandedState=!1;var c=b.suggestSeparator,h=b.multiSuggests,d=b.suggestEscapeStart,g=b.suggestEscapeEnd;null!=c&&(c=b.suggestSeparator=RegExp(c instanceof RegExp?c.source:c+"",(c.ignoreCase?"ig":"g")+(c.multiline?"m":"")));void 0===h&&b.searchLast&&(b.getSuggest=r,b.setSuggest=E);d&&g?(d instanceof
RegExp||(b.suggestEscapeStart=RegExp("(?:[^\\\\]|^)"+d)),g instanceof RegExp||(b.suggestEscapeEnd=RegExp("(?:[^\\\\]|^)"+g))):b.suggestEscapeStart=b.suggestEscapeEnd=null;b.getData&&this.addTrigger("suggests:getData",e.bind(this,b.getData));b.afterGetData&&this.addTrigger("suggests:getData:after",b.afterGetData);b.multiSuggests&&!b.setSuggest&&(b.setSuggest=function(a,b){return b});this.opts=b=p.extend(new m,b);this._cache={};this.$Elm=a;this.$Input=null;this.applyToInput(this.findSub(b.cnInput));
this.$Suggest=this.findSub(b.cnSuggest).bind("click mousedown",function(a){if(this._down="mousedown"==a.type)this.__bluredCaret=p.getCaretPosition(this.$Input[0]);this._delayedHideStart()}.bind(this));this.$InternetCont=this.findSub(b.cnInternetCont).bind("click",this.hide.bind(this));this.$Internet=this.findSub(b.cnInternet);this.$List=this.findSub(b.cnList).bind("click",this._selectByClick.bind(this)).bind("scroll",this._onScroll.bind(this)).bind("mousewheel DOMMouseScroll",this._onMouseWheel);
b.markByMouseOver&&this.$List.bind("mouseover",this._suggestNodeMouseover.throttle(100,this));b.fetching&&(this._fetchOnScroll=this._fetchOnScroll.throttle(250,this),this.$List.bind("scroll",function(a){a.preventDefault();a.stopPropagation();this._fetchOnScroll()}.bind(this)));b.expire&&(this.__prevRequestTime=+new Date);p(window).bind("hashchange popstate",this);Array.forEach(["cnItem","cnItemTick","cnSelected","cdGroupHeader","cdSuggestHint"],function(a){var b=this.opts[a];b&&(this.opts[a]=this.buildClassName(b))},
this);this._timeoutHandler=function(){var a=this._timeoutFunction,b=this._timeoutArguments;this._timeoutFunction=this._timeoutArguments=null;a&&(Array.isArray(b)?a.apply(this,b):null!=b?a.call(this,b):a.call(this))}.bind(this);b=null}var c=encodeURIComponent,l=String.prototype.split,y=3!="1_1".split(/(_)/).length?function(a,b){var c=this;if(!(a instanceof RegExp))return void 0===a&&0===b?[]:l.call(c,a,b);var h=[],d=0,e,g,k;a=RegExp(a.source,(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.extended?"x":
"")+(a.sticky?"y":"")+"g");c+="";b=void 0===b?4294967295:b>>>0;if(!b)return[];for(;e=a.exec(c);){g=e.index+e[0].length;if(g>d&&(h.push(c.slice(d,e.index)),1<e.length&&e.index<c.length&&h.push.apply(h,e.slice(1)),k=e[0].length,d=g,h.length>=b))break;a.lastIndex===e.index&&a.lastIndex++}d===c.length?!k&&a.test("")||h.push(""):h.push(c.slice(d));return h.length>b?h.slice(0,b):h}:l,k=n.HTML.escape,g=n.ui.ajsUIComponent,d=Object.isObject;m.prototype={constructor:m,cnInput:"js-input",cnSuggest:"js-suggest",
cnList:"&__suggest__inner",cnItem:"&__suggest__item",cnItemTick:"&__suggest__item__tick",cnSelected:"&__suggest__item_selected",cnInternetCont:"&__suggest__item_internet",cnInternet:"&__suggest__item_internet-link",cdGroupHeader:"&__suggest__group-header",cdSuggestHint:"&__suggest__item__hint",getData:function(a){return(a=a&&a.data||a)&&"OK"==a[1]&&a[2]},template:function(a,b){var c=(d(b)&&(b.suggest||b.text||b.word)||b||"")+"",h=(d(b)&&(b.text||b.word)||b||"")+"",h=k(h),c=k(c);a=k(a);h=h.replace(RegExp(a,
"i"),'<b class="'+this.opts.cnItemTick+'">$&</b>');return'<div data-suggest="'+c+'" class="'+this.opts.cnItem+'">'+h+"</div>"},groupHeaderTemplate:function(a){return'<div class="'+this.opts.cdGroupHeader+'">'+a+"</div>"},templateInternetVal:function(a){return k(a)},request:function(a,b,c){p.get(a,b)},multiSuggests:!1,suggestSeparator:/\s/g,suggestEscapeStart:null,suggestEscapeEnd:null,getSuggest:function(a){return a.trim()},setSuggest:p.noop,minLength:1,maxLength:0,timeout:300,expire:0,autosubmit:!0,
ajaxUrl:void 0,searchUrl:"http://go.mail.ru/search?q=#query#",encodeBeforeSend:!0,showInternet:!0,ondraw:p.noop,grouping:!1,fetching:!1,fetchCount:30,markByMouseOver:!0,autoMarked:-1,undeterminedStage:!0,selectInputDiff:!1,selectByTab:!1,hideInactive:!0,useCache:!0,searchLast:!1,findLastWord:/^.*\s+/,ondata:p.noop,onprint:null,onexpand:p.noop,onsearch:p.noop,onselect:p.noop};p.inherits(q,g,{handleEvent:function(a,b){if(!this.__disabled){var c=a.keyCode,h=this.opts,d=h.hideInactive,e,g,k,l=!0;void 0===
b&&(b=b||a.type);if(e=+this.$Input.attr("data-prevent-event-"+b))--e,e?this.$Input.attr("data-prevent-event-"+b,e):this.$Input[0].removeAttribute("data-prevent-event-"+b);else if(this.blurred=u.activeElement!=this.$Input[0],!this.blurred||"blur"===b){switch(b){case "hashchange":case "popstate":case "blur":this._down&&"blur"===b?this._down&&(this._down=l=!1,u.activeElement!==this.$Input[0]&&(this.$Input.attr("data-prevent-event-focus",1),this.$Input[0].focus(),(g=this.__bluredCaret)&&n.$.setCaretPosition(this.$Input[0],
g.start,g.end),this._findValue())):!1!==this._fireActiveEvent(!1)&&(this.blurred=!0,d&&(g=this.__currentMarkedChangeValue,!1!==this.hide()&&(g&&this._onselect(a,g),k=!0)));break;case "keyup":case "keydown":d=this.isExpanded();if(38!=c&&40!=c||!d)if(39==c&&this.__currentMarkedChangeValue)this._onselect(a,this.__currentMarkedChangeValue);else if(13==c||9==c&&h.selectByTab){if(9==c&&a&&a.ctrlKey)return;"keydown"==b&&d&&(this.__currentMarked?this._onselect(a,this.__currentMarked,!0,h.autosubmit,!1,9==
c||39==c):this.hide())}else if(27==c)"keyup"==b&&!1!==this.hide(a)&&(this._findValue(null),a.preventDefault(),k=!0);else{this.handleEvent(a,"keyup"==b?"onprint":null);return}else"keydown"==b&&this._mark(38==c?-1:0),a.preventDefault(),a.stopPropagation();break;default:if("focus"===b&&!1===this._fireActiveEvent(!0))return;k=this._down=!1;if(!1!==(c=this._checkSomethingIsChanges())&&(this.__currentMarkedChangeValue=this.__currentMarked=null,h.useCache?d=this._cache[c]||null:(this._cache={},d=null),e=
h.expire&&this.__prevRequestTime>+new Date+1E3*h.expire,e={type:"suggests:find",originalEvent:a,findValue:0<h.maxLength?c.substr(0,h.maxLength):c,data:d,expire:e},e.val=e.findValue,!1!==this.fireTrigger(e))){this._loadVal=null;this._internetVal(c);c=c!=e.val?e.val:e.findValue;if(d=e.data)this._cache[c]=d;"onprint"==b&&h.onprint&&h.onprint.call(this,c,this);e.expire&&(this.reset(),d=null);this._tid&&(clearTimeout(this._tid),this._tid=this._timeoutFunction=this._timeoutArguments=null);d?(delete e.expire,
this._timeoutFunction=this._rebuild,this._timeoutArguments=e,this._tid=setTimeout(this._timeoutHandler)):this._checkPrevResultIsNotEmpty(c,h)&&(this._timeoutFunction=this.find,this._timeoutArguments=c,this._tid=setTimeout(this._timeoutHandler,h.timeout))}}k&&this._tid&&(clearTimeout(this._tid),this._tid=this._timeoutFunction=this._timeoutArguments=null);l&&this._delayedHideEnd()}}},applyToInput:function(a,b){this.$Input&&this.$Input.unbind("blur focus click keyup keydown",this);this.$Input=p(a).attr("autocomplete",
"off").bind("blur focus click keyup keydown",this);!b&&(this.$Suggest&&this.isExpanded())&&this._rebuild(this.__val)},_checkSomethingIsChanges:function(){var a=this._findValue(),b;if(b=this.__currentMarkedChangeValue)if(b=b.getAttribute("data-suggest"),b==a)return!1;this.__prevSuggest.caret=this.__prevSuggest.val=null;return this._findValue()},_checkPrevResultIsNotEmpty:function(a,b){if(!b.useCache)return!0;for(var c=a.length-1,h,d=this._cache;c>=b.minLength;c--)if(h=a.substr(0,c),void 0!==d[h])return(h=
d[h])&&0<h.length;return!0},_closest:function(a,b){var c=this.$List[0];do if(1==a.nodeType&&"getAttribute"in a&&(b=a.getAttribute("data-suggest-idx"),0<b))return a;while(a&&(a=a.parentNode)&&a!==c)},_suggestNodeMouseover:function(a){if(!this.__disabled){var b;a.target.parentNode&&(b=this._closest(a.target));b&&this._mark(void 0,b,void 0,!1,a)}},_selectByClick:function(a){if(!this.__disabled){var b=this.opts,c=this._closest(a.target);c&&!1!==this._mark(null,c,!0,void 0,a)&&this._onselect(a,c,!0,b.autosubmit);
return!1}},_mark:function(a,b,c,d,e){if(!(void 0!==b&&this.__currentMarked===b&&!!this.__currentMarkedChangeValue==d||this.__inFetching)){var g=this.opts,k=this.$List,l=this.__currentMarked||this.__currentMarkedChangeValue,m,B,n,v=this.__ListItems,q,w,r;void 0===d&&(d=!0);if(v){c=l&&l.getAttribute("data-suggest")||null;q=v.size();m=B=(l&&~~l.getAttribute("data-suggest-idx")||0)-1;if(b)B=~~b.getAttribute("data-suggest-idx")-1;else{B=l?B+(0>a?-1:1):0>a?q-1:0;for(B=B>=q?-1:B;!b&&B<q&&0<=B;)b=v[B],b&&
"none"!=b.style.display||(b=null,0>a?B--:B++);if(!b||0>B)B=-1,b=null}r=this.__val;n=null!=r&&this._cache[r];if(!b&&(-1<a&&-1<m&&g.fetching&&!n.EOF)&&!1!==this._fetchMore(a,this._mark.bind(this,a)))return;(B>=q||0>B)&&!g.undeterminedStage&&(B=0>a?q-1:0,b=v[B]);b&&(a=b.getBoundingClientRect(),v=k[0].getBoundingClientRect(),0==B?k[0].scrollTop=0:a.top<v.top?k[0].scrollTop+=a.top-v.top:a.bottom>v.bottom&&(k[0].scrollTop+=a.bottom-v.bottom));e={type:"suggests:mark",oldSuggestIndex:m,oldSuggestData:0<=
m&&n&&n[m]||null,oldSuggestNode:l,oldSuggest:c,newSuggestIndex:B,newSuggestData:0<=B&&n&&n[B]||null,newSuggestNode:b,newSuggest:c=b&&b.getAttribute("data-suggest")||null,updateInputValue:d,findValue:r,originalEvent:e||null};g=g.selectInputDiff;d&&g?(w=(w=this.__prevSuggest.caret)?w.end:r.length,m=w+(c||"").length):m=w=-1;e.caretPositionStart=w;e.caretPositionEnd=m;if(!1!==this.fireTrigger(e))if(c=e.newSuggest,m=e.caretPositionEnd,w=e.caretPositionStart,void this._cancelMark(),b){if(p.addClass(b,this.opts.cnSelected),
this.__currentMarked=b,d!=(d=e.updateInputValue)&&(d&&g&&-1===m&&w===m)&&(w=(w=this.__prevSuggest.caret)?w.end:r.length,m=w+(c||"").length),d=e.updateInputValue)this.__currentMarkedChangeValue=this.__currentMarked}else this.__currentMarkedChangeValue=this.__currentMarked=null;else return!1}else c=l.attr("data-suggest");d&&this._findValue(c,null,d&&-1<w?w:void 0,d&&-1<m?m:void 0)}},_onselect:function(a,b,c,d,e,g){var k=this.opts,l=b.getAttribute("data-suggest"),m=b.getAttribute("data-suggest-idx")-
1,B=this._cache[this.__val],n=this.$Input,q=this._getSuggestReplacement(),r=q?q.inputValue:n.val();e={type:"suggests:select",newSuggest:l,newSuggestData:B&&B[m],newSuggestIndex:m,newSuggestNode:b,findValue:this.__val,inputValue:r,inputValueLeftPart:q?q.leftPart:"",inputValueRightPart:q?q.rightPart:"",inputSelectionStart:-1,inputSelectionEnd:-1,changeInputValue:!e,originalEvent:a||null,submitForm:d||!1};var w;c&&d||p.removeClass(b,k.cnSelected);b=k.onselect.call(this,e,this);if(!1!==b){if(!1!==(b=
this.fireTrigger(e))){this.__currentMarkedChangeValue=this.__currentMarked=null;e.changeInputValue&&this._findValue(e.newSuggest,q,-1!=(m=e.inputSelectionStart)?m:void 0,-1!=(m=e.inputSelectionEnd)?m:void 0);a&&!g&&(a.stopPropagation(),a.preventDefault());if(e.submitForm&&(a=n.closest("form")[0]))for(var m=a.length,y;m--;)if((y=a[m])&&"submit"==y.type){y.click();break}w=!0}g||this.$Input[0].focus();w&&this.hide()}this.__prevSuggest.caret=this.__prevSuggest.val=null;return b},_cancelMark:function(){var a=
this.opts.cnSelected,b=this.$List.find("."+a);b.length&&b.removeClass(a);return b},_loaded:function(a,b,c){if(b||u.activeElement==this.$Input[0]){var d=this.opts,e=d.hideInactive;c={data:c,findValue:a,type:"suggests:getData"};c.suggestValue=a;!1!==this.fireTrigger(c)&&(c.type+=":after",this.fireTrigger(c),this._cache[a]=c=c.data,d.ondata.call(this,a,c,this),!b&&(this._loadVal!=a||e&&this.blurred)||this._rebuild(a,void 0,void 0,void 0,!0===b))}},_rebuild:function(a,b,c,h,e){null==b&&(b=-1);var g=this.opts,
k=d(a),l=k?a.findValue:a,m=null!=l&&"string"==typeof l,n=m&&this._cache[l]||[],q=n&&!(!n.length&&!n.toArray),v=-1<b?b+(void 0!=c?c:g.fetchCount):-1,r,w=g.grouping,n={type:"suggests:rebuild",showContainer:e||q&&m,showList:q,showInternet:g.showInternet,data:n,findValue:l,dataFrom:b,dataTo:v,markedItem:g.autoMarked};a=k?p.extend(a,n):n;a.suggest=l;n=a.data;!Array.isArray(n)&&n.toArray&&(n=n.toArray());a.showList=q;a.showContainer=a.showContainer&&(a.showList||a.showInternet);if(a.showContainer&&!1!==
this.fireTrigger(a)&&(b=a.dataFrom,-1!==b&&(Infinity===b&&(b=this.__ListItems&&this.__ListItems.length-1),h||(h=this.__ListItems&&this.__ListItems[b])),v=a.dataTo,-1===v&&-1!==b&&(v=-1<b?b+(void 0!=c?c:g.fetchCount):-1),h||this.__val!==(l=a.findValue!=l?a.findValue:a.suggest))){this.__inFetching=!1;this.__currentMarked=h||null;this.__val=l;if(a.showList){c=-1<b?b+1:0;q=-1<v&&n.length>v?v+1:n.length;v=[];for(k=A(l);c<q;c++)if(e=n[c])w&&(d(e)&&e.groupHeader)&&v.push(p.trim(g.groupHeaderTemplate.call(this,
e.groupHeader,k,e))),v.push(p.trim(g.template.call(this,k,e,c,n,l)));if(v.length)if(-1<b&&h)v=p(v.join("")),p(h).after(v),v=v.filter("."+g.cnItem),this.__ListItems.add(v),Array.forEach(v,function(a,c){a.setAttribute("data-suggest-idx",c+b+2)});else if(this.__ListItems=this.$List.html(v.join("")).find("."+g.cnItem).each(function(a,b){b.setAttribute("data-suggest-idx",a+1)}),v=this.$List[0])v.scrollTop=0}g.ondraw.call(this,l,n,this)}delete a.dataFrom;delete a.dataTo;!1!==this._onExpand(a.showContainer,
a)&&(this.$List.toggle(a.showList),this.$Suggest.toggle(a.showContainer),this.$InternetCont.toggle(a.showInternet));!this.__currentMarked&&(a.showContainer&&a.showList&&Number.isInteger(r=a.markedItem)&&0<=r)&&this._mark(r,void 0,void 0,!1);a.type="suggests:afterRebuild";this.fireTrigger(a);a.data=null},_request:function(a,b,c){this.opts.request(a,b,c)},_internetVal:function(a){var b=this.opts;a=k(a);b.showInternet&&(this.$InternetCont.attr("href",b.searchUrl.replace("#query#",b.encodeBeforeSend?
c(a):a)),!1!==(a=b.templateInternetVal.call(this,a,this.$InternetCont,this.$Internet))&&(b=this.$Internet,b.size()&&(b.attr("innerHTML","")[0].innerHTML=a)))},_onExpand:function(a,b,c){if(this.__expandedState!==a){this.opts.onexpand.call(this,a,this);b=b||{};b.type="suggests:"+(a?"show":"hide");c&&(b.originalEvent=c);if(!1===this.fireTrigger(b))return!1;this.__expandedState=a}else return!1},val:function(a){return void 0!==a?(this._internetVal(a),this.$Input.val(a),""!=a||this._cache[a]||this.hide(),
this):this._findValue()},getFindWords:function(){var a=this.opts,b=a.multiSuggests,c=a.suggestSeparator,d=this.$Input[0],e=d.value,g,l,k,m,p=null,n,q=a.suggestEscapeStart,r=q&&a.suggestEscapeEnd,w;if(a=this.hasTrigger("suggests:getSuggestWords suggests:getSuggestWords:AFTER")){w={type:"suggests:getSuggestWords",input:d,inputValue:e,data:null};if(!1===this.fireTrigger(w))return[];e=w.inputValue}if(b){b=y.call(e,c);d=[];c=RegExp(c.source,(c.global?"g":"")+(c.ignoreCase?"i":"")+(c.multiline?"m":""));
g=b.length;for(l=0;l<g;++l){k=b[l];(m=c.exec(e))&&(m=m[0]);if(q&&k)if(null!=p){if(-1!==(n=k.search(r))){b[p]=d.slice(p,l).join("")+k;for(p++;p<=l;p++)b[p]=null;p=null}}else-1!==(n=k.search(q))&&(n=k.substr(n+1).search(r),-1===n&&(p=l));q&&(d[l]=b[l]+(m||""))}c=Array.filter(b,function(a){return!!a})}else c=[e];a&&(w.data=c,w.type="suggests:getSuggestWords:AFTER",!1!==this.fireTrigger(w)&&(c=w.data));return c},_getSuggestReplacement:function(a){var b=this.opts,c=b.multiSuggests,d,e,g;d=this.$Input;
var l=d.val(),k,m,n,q,r,u,w,A=null,E,F,M,J,N;if(c){d=this.__prevSuggest.caret||p.getCaretPosition(d[0]);if(!d)return;e=d.start;g=d.end;if(!this.__prevSuggest.caret){c=b.suggestSeparator;n=0;M=(F=b.suggestEscapeStart)&&b.suggestEscapeEnd;b=y.call(l,c);c=RegExp(c.source,(c.global?"g":"")+(c.ignoreCase?"i":"")+(c.multiline?"m":""));q=b.length;for(r=0;r<q;++r){u=b[r];(w=c.exec(l))&&(w=w[0]);F&&u&&(null!==A?-1!==u.search(M)&&(n=b.slice(0,A).join("").length,u=b.slice(A,r+1).join(""),A=null):-1!==(E=u.search(F))&&
(E=u.substr(E+1).search(M),-1===E&&(A=r)));u=u.length;if((n+=u)>=e)if(null===A){e=n-u;g=n;break}else void 0===J&&(J=n-u,N=n);w&&(n+=w.length);F&&w&&(b[r]+=w)}null!==A&&void 0!==J&&(e=J,g=N);d.start=e;d.end=g;this.__prevSuggest.caret=d}a?d=null:(k=l.substring(0,e),m=l.substring(g,l.length));return{position:d,start:e,end:g,value:l,leftPart:k,rightPart:m}}return null},_findValue:function(a,b,c,d){var e=void 0===a,g=this.opts,l=this.$Input,k,m,n,q;b||(b=this._getSuggestReplacement(e));if(null===a&&(a=
this.__val,null==a))return;b?(k=b.value,m=b.position,n=b.start,q=b.end,e?a=k.substring(n,q):(k=b.leftPart,b=b.rightPart,k=k+a+b,q=m.end=m.start+a.length)):e?a=l.val():g.searchLast||(k=a);k=g[e?"getSuggest":"setSuggest"].call(this,a,k,g,n,q);if(e)return this.__prevSuggest.val=k;this.val(k);void 0==q&&(q=k.length);Infinity==c&&(c=k.length);Infinity==d&&(d=k.length);p.setCaretPosition(l[0],void 0!=c?c:q,void 0!=d?d:q)},find:function(a,b){var d=this.opts,e=d.ajaxUrl;d.needUpdateValue&&(d.needUpdateValue=
!1,a=this._findValue());if(!b&&(!e||!a&&0<d.minLength))this.hide();else if(this._loadVal!=a||this._loadUrl!=e)this._loadUrl=e,this._loadVal=a,d.onsearch.call(this,a,this),this._request(e.replace("#query#",d.encodeBeforeSend?c(a):a)+"&"+Math.random(),this._loaded.bind(this,a,b),a)},set:function(a,b,c){this.opts[a]=b;"ajaxUrl"==a&&(this._cache=[],this.__val="");c||this.find(this.val());return this},get:function(a){return this.opts[a]},reset:function(){var a=this._loadVal,b=this._cache[a];this.__val=
this._loadVal=void 0;this._cache={};this.isExpanded()&&b&&(this._cache[a]=b)},show:function(a){this._rebuild(a||this.val())},hide:function(a){this._down=!1;if(!1===this._onExpand(!1,null,a))return!1;this.__currentMarkedChangeValue=null;this.$Suggest.hide();this._delayedHideEnd();clearTimeout(this._tid)},showSuggests:function(a,b,c,d){b&&void 0!=a&&this.val(a);void 0===a&&(a=this.val());void 0===c&&(c=this._cache[a]);d&&(this.$Input.attr("data-prevent-event-focus",1),this.$Input[0].focus(),this.val(),
this.blurred=!1);clearTimeout(this._tid);c?this._loaded(a,!0,c):this._tid=setTimeout(this.find.bind(this,a,!0),this.opts.timeout)},isExpanded:function(){return!0===this.__expandedState},_fetchMore:function(a,b){if(!this.opts.fetching)return!1;void 0===a&&(a=1);var c=this.__val,d=this._cache[c],e=(d&&d.length||0)-1,g=0<=e?this.__ListItems[e]:null;if(!g||!d||d.EOF)return!1;d={type:"suggests:fetch",fetchFrom:e,fetchCount:this.opts.fetchCount,fetchDirection:0>a?"UP":"DOWN",data:d,findValue:c,EOF:!1,async:!1,
currentDataLength:d.length,insertAfter:g};d.val=c;d.suggestValue=c;!1!=(c=this.fireTrigger(d))&&(!0!==d.async?(this[d.type](d,b),this.__inFetching=!1):this._asynchMarkers[d.type]?d.async=!1:(this._asynchMarkers||(this._asynchMarkers={}),d._asynchMarker=this._asynchMarkers[d.type]=+new Date,d._next_callback=b,d.next=this._callTriggerFunctionAsync,this.__inFetching=!d.EOF));return c},_fetchOnScroll:function(){if(this.isExpanded()&&!this.__inFetching){var a=this.$List[0];a.offsetHeight+a.scrollTop+20>
a.scrollHeight&&this._fetchMore()}},"suggests:fetch":function(a,b){var c=a.currentDataLength,d=a.insertAfter,e=a.suggestValue,g,k;b=b||a._next_callback;g=this._cache[e]=a.data;if(g.length==c||a.EOF)a.EOF=g.EOF=!0;if(g.EOF||!d&&!(d=this.__ListItems[a.fetchFrom]))k=a.result=!1;!1!==k&&(this._rebuild(e,a.fetchFrom,a.fetchCount,d),b&&b());this.__inFetching=!1;return k},getCurrentFindValue:function(){return this.__val},_hideIfNotActiveInput:function(){this._down=!1;u.activeElement!=this.$Input[0]&&this.hide()},
_delayedHideStart:function(){this.__delayedHide=setTimeout(this._hideIfNotActiveInput.bind(this),500)},_delayedHideEnd:function(){this.__delayedHide&&(clearTimeout(this.__delayedHide),this.__delayedHide=null)},_onMouseWheel:function(a){var b=a.wheelDelta||-1*a.detail;if(b){var c=a.currentTarget,d=c.scrollTop,e=c.scrollHeight,c=c.clientHeight;if(0<b?0==d:e<=c+d)a.preventDefault(),a.stopPropagation()}},_onScroll:function(){this._down=!1;this._delayedHideEnd()},_fireActiveEvent:function(a){return this.fireTrigger({type:"suggests:active"+
(a?"In":"Out")})}});q.prototype.getSuggestWords=q.prototype.getFindWords;n.ui.suggest=q}(document,this.ajs,this.ajs.$);
